{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Job meta data",
    "description": "Meta data information of a HPC job",
    "type": "object",
    "properties": {
        "job_id": {
            "description": "The unique identifier of a job",
            "type": "integer"
        },
        "user": {
            "description": "The unique identifier of a user",
            "type": "string"
        },
        "project": {
            "description": "The unique identifier of a project",
            "type": "string"
        },
        "cluster": {
            "description": "The unique identifier of a cluster",
            "type": "string"
        },
        "partition": {
            "description": "The queue to which the job was submitted",
            "type": "string"
        },
        "array_job_id": {
            "description": "The unique identifier of an array job",
            "type": "integer"
        },
        "num_nodes": {
            "description": "Number of nodes used",
            "type": "integer",
            "exclusiveMinimum": 0
        },
        "num_hwthreads": {
            "description": "Number of HWThreads used",
            "type": "integer",
            "exclusiveMinimum": 0
        },
        "num_acc": {
            "description": "Number of accelerators used",
            "type": "integer",
            "exclusiveMinimum": 0
        },
        "exclusive": {
            "description": "Job uses only exclusive nodes",
            "type": "integer"
        },
        "monitoring_status": {
            "description": "State of monitoring system during job run",
            "type": "integer"
        },
        "smt": {
            "description": "SMT threads used by job",
            "type": "integer"
        },
        "walltime": {
            "description": "Requested walltime of job in seconds",
            "type": "integer",
            "exclusiveMinimum": 0
        },
        "job_state": {
            "description": "Final state of job",
            "type": "string",
            "enum": [
                "completed",
                "failed",
                "canceled",
                "stopped",
                "timeout"
            ]
        },
        "start_time": {
            "description": "Start epoch time stamp in seconds",
            "type": "integer",
            "exclusiveMinimum": 0
        },
        "stop_time": {
            "description": "Stop epoch time stamp in seconds",
            "type": "integer",
            "exclusiveMinimum": 0
        },
        "duration": {
            "description": "Duration of job in seconds",
            "type": "integer",
            "exclusiveMinimum": 0
        },
        "resources": {
            "description": "Resources used by job",
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "hostname": {
                        "type": "string"
                    },
                    "hwthreads": {
                        "type": "array",
                        "description": "List of OS processor ids",
                        "items": {
                            "type": "integer"
                        }
                    },
                    "accelerators": {
                        "type": "array",
                        "description": "List of of accelerator devices",
                        "items": {
                            "type": "object",
                            "properties": {
                                "id": {
                                    "type": "string",
                                    "description": "The unique device id"
                                },
                                "type": {
                                    "type": "string",
                                    "description": "The accelerator type",
                                    "enum": [
                                        "Nvidia GPU",
                                        "AMD GPU",
                                        "Intel GPU"
                                    ]
                                },
                                "model": {
                                    "type": "string",
                                    "description": "The accelerator model"
                                }
                            },
                            "required": [
                                "id",
                                "type",
                                "model"
                            ]
                        }
                    },
                    "configuration": {
                        "type": "string",
                        "description": "The configuration options of the node"
                    },
                    "required": [
                        "hostname"
                    ]
                },
                "minItems": 1
            }
        },
        "meta_data": {
            "description": "Additional information about the job",
            "type": "object",
            "properties": {
                "job_script": {
                    "type": "string",
                    "description": "The batch script of the job"
                },
                "slurmdata": {
                    "type": "string",
                    "description": "Additional Slurm information"
                }
            }
        },
        "tags": {
            "description": "List of tags",
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string"
                    },
                    "type": {
                        "type": "string"
                    }
                },
                "required": [
                    "name",
                    "type"
                ]
            },
            "uniqueItems": true
        },
        "statistics": {
            "description": "Job statistic data",
            "type": "object",
            "properties": {
                "mem_used": {
                    "description": "Memory capacity used (required)",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "cpu_load": {
                    "description": "CPU requested core utilization (load 1m) (required)",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "flops_any": {
                    "description": "Total flop rate with DP flops scaled up (required)",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "mem_bw": {
                    "description": "Main memory bandwidth (required)",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "net_bw": {
                    "description": "Total fast interconnect network bandwidth (required)",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "file_bw": {
                    "description": "Total file IO bandwidth (required)",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "ipc": {
                    "description": "Instructions executed per cycle",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "cpu_used": {
                    "description": "CPU active core utilization",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "flops_dp": {
                    "description": "Double precision flop rate",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "flops_sp": {
                    "description": "Single precision flops rate",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "rapl_power": {
                    "description": "CPU power consumption",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "gpu_used": {
                    "description": "GPU utilization",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "gpu_mem_used": {
                    "description": "GPU memory capacity used",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "gpu_power": {
                    "description": "GPU power consumption",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "clock": {
                    "description": "Average core frequency",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "eth_read_bw": {
                    "description": "Ethernet read bandwidth",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "eth_write_bw": {
                    "description": "Ethernet write bandwidth",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "pfs_read_bw": {
                    "description": "Parallel file system read bandwidth",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "pfs_write_bw": {
                    "description": "Parallel file system write bandwidth",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "pfs_read_req": {
                    "description": "Parallel file system read requests",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "pfs_write_req": {
                    "description": "Parallel file system write requests",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "pfs_inodes": {
                    "description": "Parallel file system inodes used",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "pfs_accesses": {
                    "description": "Parallel file system open and close",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "pfs_fsync": {
                    "description": "Parallel file system fsync",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "pfs_create": {
                    "description": "Parallel file system create",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "pfs_open": {
                    "description": "Parallel file system open",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "pfs_close": {
                    "description": "Parallel file system close",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "pfs_seek": {
                    "description": "Parallel file system seek",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "fs_read_bw": {
                    "description": "Local file system read bandwidth",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "fs_write_bw": {
                    "description": "Local file system write bandwidth",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "fs_inodes": {
                    "description": "Local file system inodes used",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "fs_accesses": {
                    "description": "Local file system open and close",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "ic_rcv_packets": {
                    "description": "Network interconnect read packets",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "ic_send_packets": {
                    "description": "Network interconnect send packet",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "ic_read_bw": {
                    "description": "Network interconnect read bandwidth",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                },
                "ic_write_bw": {
                    "description": "Network interconnect write bandwidth",
                    "#ref": "https://github.com/ClusterCockpit/cc-specifications/blob/master/schema/json/job-metric-data.schema.json"
                }
            },
            "required": [
                "mem_used",
                "cpu_load",
                "flops_any",
                "mem_bw",
                "net_bw",
                "file_bw"
            ]
        }
    },
    "required": [
        "job_id",
        "user_id",
        "project_id",
        "cluster_id",
        "num_nodes",
        "start_time",
        "stop_time",
        "duration",
        "resources",
        "tags",
        "statistics"
    ]
}
